var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function s(e){e.forEach(t)}function i(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let l,o;function r(e,t){return l||(l=document.createElement("a")),l.href=t,e===l.href}function c(e,t){e.appendChild(t)}function v(e,t,n){e.insertBefore(t,n||null)}function d(e){e.parentNode&&e.parentNode.removeChild(e)}function u(e){return document.createElement(e)}function p(e){return document.createTextNode(e)}function b(){return p(" ")}function h(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function f(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function g(e){return""===e?null:+e}function m(e,t){t=""+t,e.data!==t&&(e.data=t)}function y(e,t){e.value=null==t?"":t}function _(e,t,n,s){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,s?"important":"")}function x(e){o=e}const $=[],w=[];let z=[];const k=[],C=Promise.resolve();let T=!1;function L(e){z.push(e)}const E=new Set;let F=0;function N(){if(0!==F)return;const e=o;do{try{for(;F<$.length;){const e=$[F];F++,x(e),O(e.$$)}}catch(e){throw $.length=0,F=0,e}for(x(null),$.length=0,F=0;w.length;)w.pop()();for(let e=0;e<z.length;e+=1){const t=z[e];E.has(t)||(E.add(t),t())}z.length=0}while($.length);for(;k.length;)k.pop()();T=!1,E.clear(),x(e)}function O(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(L)}}const S=new Set;function G(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];z.forEach((s=>-1===e.indexOf(s)?t.push(s):n.push(s))),n.forEach((e=>e())),z=t}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function j(e,t){-1===e.$$.dirty[0]&&($.push(e),T||(T=!0,C.then(N)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function M(a,l,r,c,v,u,p,b=[-1]){const h=o;x(a);const f=a.$$={fragment:null,ctx:[],props:u,update:e,not_equal:v,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l.context||(h?h.$$.context:[])),callbacks:n(),dirty:b,skip_bound:!1,root:l.target||h.$$.root};p&&p(f.root);let g=!1;if(f.ctx=r?r(a,l.props||{},((e,t,...n)=>{const s=n.length?n[0]:t;return f.ctx&&v(f.ctx[e],f.ctx[e]=s)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](s),g&&j(a,e)),t})):[],f.update(),g=!0,s(f.before_update),f.fragment=!!c&&c(f.ctx),l.target){if(l.hydrate){const e=function(e){return Array.from(e.childNodes)}(l.target);f.fragment&&f.fragment.l(e),e.forEach(d)}else f.fragment&&f.fragment.c();l.intro&&((m=a.$$.fragment)&&m.i&&(S.delete(m),m.i(y))),function(e,n,a,l){const{fragment:o,after_update:r}=e.$$;o&&o.m(n,a),l||L((()=>{const n=e.$$.on_mount.map(t).filter(i);e.$$.on_destroy?e.$$.on_destroy.push(...n):s(n),e.$$.on_mount=[]})),r.forEach(L)}(a,l.target,l.anchor,l.customElement),N()}var m,y;x(h)}class A{$destroy(){G(this,1),this.$destroy=e}$on(t,n){if(!i(n))return e;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const e=s.indexOf(n);-1!==e&&s.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function H(t){let n;return{c(){n=u("p"),n.textContent="Loading visualization...",f(n,"class","svelte-6v464b")},m(e,t){v(e,n,t)},p:e,d(e){e&&d(n)}}}function P(e){let t,n;return{c(){t=u("img"),r(t.src,n=e[10])||f(t,"src",n),f(t,"alt","Visualization"),f(t,"class","svelte-6v464b")},m(e,n){v(e,t,n)},p(e,s){1024&s&&!r(t.src,n=e[10])&&f(t,"src",n)},d(e){e&&d(t)}}}function I(t){let n,a,l,o,r,g,x,$,w,z,k,C,T,L,E,F,N,O,S,G,j,M,A,I,V,D,R,W,q,U,B,J,Z,K,Q,X,Y,ee,te,ne,se,ie,ae,le,oe,re,ce,ve,de,ue,pe,be,he,fe,ge,me,ye,_e,xe,$e,we,ze,ke,Ce,Te,Le,Ee,Fe,Ne,Oe,Se,Ge,je,Me,Ae,He,Pe,Ie,Ve,De,Re,We,qe,Ue,Be,Je,Ze,Ke,Qe,Xe,Ye,et,tt,nt,st,it,at,lt,ot,rt,ct,vt,dt,ut,pt,bt=t[9]?"Stop":"Start",ht=t[3].toFixed(4)+"",ft=t[4].toFixed(3)+"";function gt(e,t){return e[10]?P:e[9]?H:void 0}let mt=gt(t),yt=mt&&mt(t);return{c(){n=u("main"),a=u("div"),l=b(),o=u("header"),o.innerHTML='<div class="container svelte-6v464b"><h1 class="title svelte-6v464b">Understanding GFlowNets</h1> \n      <p class="subtitle svelte-6v464b">Gaining intuition for Generative Flow Networks and how to train them</p></div>',r=b(),g=u("section"),g.innerHTML='<h2 class="section-title svelte-6v464b">What is a GFlowNet?</h2> \n    <p class="section-text svelte-6v464b">Short Description: What can they do, how do they work, advantages</p> \n\n    <h2 class="section-title svelte-6v464b">Toy Environment</h2> \n    <p class="section-text svelte-6v464b">A 2-dimensional multivariate Gaussian environment with two modes. GFlowNet\n      takes steps in the x or y direction, and rewards are calculated based on the mixture of\n      Gaussians.</p> \n    <ul class="bullet-list svelte-6v464b"><li class="svelte-6v464b">Variable sequence length is typically supported, but fixed here for simplicity.</li> \n      <li class="svelte-6v464b">State does not depend on the order of steps.</li> \n      <li class="svelte-6v464b">Added a counter to avoid circular paths in the graph.</li></ul> \n    <div class="image-container svelte-6v464b"><img src="/images/env1.png" class="image svelte-6v464b" alt="Rendering of the environment"/></div>',x=b(),$=u("section"),$.innerHTML='<h2 class="section-title svelte-6v464b">Training</h2> \n    <p class="section-text svelte-6v464b">Visualizing how GFlowNet samples from the underlying distribution.\n      -&gt; Learns full distribution given enough compute\n      TODO: Add slider over training iterations to visualizations to add interactivity and see training progress</p> \n    <div class="image-container svelte-6v464b"><img src="/images/run1.png" class="image svelte-6v464b" alt="GFN samples from the underlying distribution"/></div> \n\n    <h2 class="section-title svelte-6v464b">Mode Collapse</h2> \n    <p class="section-text svelte-6v464b">If there is little probability mass between modes, we see mode collapse.</p> \n    <div class="image-container svelte-6v464b"><img src="/images/run2.png" class="image svelte-6v464b" alt="Low variance leads to sampling from one mode"/></div> \n    <p class="section-text svelte-6v464b">Training off-policy mitigates this issue.\n      We added variance to each step -&gt; more exploring</p> \n    <div class="image-container svelte-6v464b"><img src="/images/run3.png" class="image svelte-6v464b" alt="Off-policy training helps"/></div>',w=b(),z=u("section"),z.innerHTML='<h2 class="section-title svelte-6v464b">Flow</h2> \n    <p class="section-text svelte-6v464b">Visualize flow between states. Probably interactive:\n      Hovering over env and displaying flow in 8 directions with arrows.\n      Probably need to discretize for this?</p>',k=b(),C=u("section"),C.innerHTML='<div class="container svelte-6v464b"><h1 class="title svelte-6v464b">Playground</h1> \n      <p class="subtitle svelte-6v464b">Change the environment and train your own GFlowNet to get a feeling on how they work.</p></div>',T=b(),L=u("section"),E=u("p"),E.textContent="change env (up to 4 gaussians, change their mean and var by dragging and scaling on the image)",F=b(),N=u("div"),N.innerHTML='<img src="/images/env1.png" class="image svelte-6v464b" alt="Rendering of the environment"/>',O=b(),S=u("p"),S.textContent="change training settings and start training (visualize training by sampling every n steps),\n      all interactivty deactivated while training, add stop button.",G=b(),j=u("div"),M=u("button"),A=p("Reset"),I=b(),V=u("button"),D=p(bt),R=b(),W=u("div"),q=u("div"),U=u("label"),U.textContent="Off-policy",B=b(),J=u("input"),Z=b(),K=u("span"),Q=p(t[1]),X=b(),Y=u("div"),ee=u("label"),ee.textContent="Iterations to train",te=b(),ne=u("input"),se=b(),ie=u("span"),ae=p(t[2]),le=b(),oe=u("div"),re=u("label"),re.textContent="Learning rate of the model",ce=b(),ve=u("input"),de=b(),ue=u("span"),pe=p(ht),be=b(),he=u("div"),fe=u("label"),fe.textContent="Learning rate of LogZ",ge=b(),me=u("input"),ye=b(),_e=u("span"),xe=p(ft),$e=b(),we=u("div"),ze=u("label"),ze.textContent="Length of trajectory",ke=b(),Ce=u("input"),Te=b(),Le=u("span"),Ee=p(t[6]),Fe=b(),Ne=u("div"),Oe=u("label"),Oe.textContent="Number of hidden layers",Se=b(),Ge=u("input"),je=b(),Me=u("span"),Ae=p(t[7]),He=b(),Pe=u("div"),Ie=u("label"),Ie.textContent="Seed (TODO)",Ve=b(),De=u("input"),Re=b(),We=u("span"),qe=p(t[8]),Ue=b(),Be=u("div"),Je=u("label"),Je.textContent="Training batch size",Ze=b(),Ke=u("input"),Qe=b(),Xe=u("span"),Ye=p(t[11]),et=b(),tt=u("div"),nt=u("label"),nt.textContent="Update visualization every n interations",st=b(),it=u("input"),at=b(),lt=u("span"),ot=p(t[5]),rt=b(),ct=u("div"),yt&&yt.c(),vt=b(),dt=u("section"),dt.innerHTML='<h2 class="section-title svelte-6v464b">Sources</h2> \n    <p class="section-text svelte-6v464b">Add sources</p>',f(a,"id","plot-container"),_(a,"width","100%"),_(a,"height","100%"),f(a,"class","svelte-6v464b"),f(o,"class","header svelte-6v464b"),f(g,"class","section svelte-6v464b"),f($,"class","section section-light svelte-6v464b"),f(z,"class","section svelte-6v464b"),f(C,"class","playground svelte-6v464b"),f(E,"class","section-text svelte-6v464b"),f(N,"class","image-container svelte-6v464b"),f(S,"class","section-text svelte-6v464b"),f(M,"class","reset-button svelte-6v464b"),M.disabled=t[9],f(V,"class","reset-button svelte-6v464b"),f(j,"class","buttonscontainer svelte-6v464b"),f(U,"for","off_policy"),f(U,"class","svelte-6v464b"),f(J,"type","range"),f(J,"min","0"),f(J,"max","3"),f(J,"step","0.1"),f(J,"id","off_policy"),J.disabled=t[9],f(J,"class","svelte-6v464b"),f(K,"class","svelte-6v464b"),f(q,"class","slider svelte-6v464b"),f(ee,"for","n_iterations"),f(ee,"class","svelte-6v464b"),f(ne,"type","range"),f(ne,"min","100"),f(ne,"max","10000"),f(ne,"step","10"),f(ne,"id","n_iterations"),ne.disabled=t[9],f(ne,"class","svelte-6v464b"),f(ie,"class","svelte-6v464b"),f(Y,"class","slider svelte-6v464b"),f(re,"for","lr_model"),f(re,"class","svelte-6v464b"),f(ve,"type","range"),f(ve,"min","0.0001"),f(ve,"max","0.1"),f(ve,"step","0.0001"),f(ve,"id","lr_model"),ve.disabled=t[9],f(ve,"class","svelte-6v464b"),f(ue,"class","svelte-6v464b"),f(oe,"class","slider svelte-6v464b"),f(fe,"for","lr_logz"),f(fe,"class","svelte-6v464b"),f(me,"type","range"),f(me,"min","0.001"),f(me,"max","0.3"),f(me,"step","0.001"),f(me,"id","lr_logz"),me.disabled=t[9],f(me,"class","svelte-6v464b"),f(_e,"class","svelte-6v464b"),f(he,"class","slider svelte-6v464b"),f(ze,"for","trajectory_length"),f(ze,"class","svelte-6v464b"),f(Ce,"type","range"),f(Ce,"min","1"),f(Ce,"max","8"),f(Ce,"step","1"),f(Ce,"id","trajectory_lenght"),Ce.disabled=t[9],f(Ce,"class","svelte-6v464b"),f(Le,"class","svelte-6v464b"),f(we,"class","slider svelte-6v464b"),f(Oe,"for","hidden_layer"),f(Oe,"class","svelte-6v464b"),f(Ge,"type","range"),f(Ge,"min","1"),f(Ge,"max","8"),f(Ge,"step","1"),f(Ge,"id","hidden_layer"),Ge.disabled=t[9],f(Ge,"class","svelte-6v464b"),f(Me,"class","svelte-6v464b"),f(Ne,"class","slider svelte-6v464b"),f(Ie,"for","seed"),f(Ie,"class","svelte-6v464b"),f(De,"type","range"),f(De,"min","0"),f(De,"max","9999"),f(De,"step","1"),f(De,"id","seed"),De.disabled=t[9],f(De,"class","svelte-6v464b"),f(We,"class","svelte-6v464b"),f(Pe,"class","slider svelte-6v464b"),f(Je,"for","batch_size"),f(Je,"class","svelte-6v464b"),f(Ke,"type","range"),f(Ke,"min","3"),f(Ke,"max","11"),f(Ke,"step","1"),f(Ke,"id","batch_size"),Ke.disabled=t[9],f(Ke,"class","svelte-6v464b"),f(Xe,"class","svelte-6v464b"),f(Be,"class","slider svelte-6v464b"),f(nt,"for","vis_every"),f(nt,"class","svelte-6v464b"),f(it,"type","range"),f(it,"min","10"),f(it,"max","500"),f(it,"step","10"),f(it,"id","vis_every"),it.disabled=t[9],f(it,"class","svelte-6v464b"),f(lt,"class","svelte-6v464b"),f(tt,"class","slider svelte-6v464b"),f(W,"class","slider-container svelte-6v464b"),f(ct,"class","visualization svelte-6v464b"),f(L,"class","section-light svelte-6v464b"),f(dt,"class","section svelte-6v464b"),f(n,"class","main-content svelte-6v464b")},m(e,s){v(e,n,s),c(n,a),c(n,l),c(n,o),c(n,r),c(n,g),c(n,x),c(n,$),c(n,w),c(n,z),c(n,k),c(n,C),c(n,T),c(n,L),c(L,E),c(L,F),c(L,N),c(L,O),c(L,S),c(L,G),c(L,j),c(j,M),c(M,A),c(j,I),c(j,V),c(V,D),c(L,R),c(L,W),c(W,q),c(q,U),c(q,B),c(q,J),y(J,t[1]),c(q,Z),c(q,K),c(K,Q),c(W,X),c(W,Y),c(Y,ee),c(Y,te),c(Y,ne),y(ne,t[2]),c(Y,se),c(Y,ie),c(ie,ae),c(W,le),c(W,oe),c(oe,re),c(oe,ce),c(oe,ve),y(ve,t[3]),c(oe,de),c(oe,ue),c(ue,pe),c(W,be),c(W,he),c(he,fe),c(he,ge),c(he,me),y(me,t[4]),c(he,ye),c(he,_e),c(_e,xe),c(W,$e),c(W,we),c(we,ze),c(we,ke),c(we,Ce),y(Ce,t[6]),c(we,Te),c(we,Le),c(Le,Ee),c(W,Fe),c(W,Ne),c(Ne,Oe),c(Ne,Se),c(Ne,Ge),y(Ge,t[7]),c(Ne,je),c(Ne,Me),c(Me,Ae),c(W,He),c(W,Pe),c(Pe,Ie),c(Pe,Ve),c(Pe,De),y(De,t[8]),c(Pe,Re),c(Pe,We),c(We,qe),c(W,Ue),c(W,Be),c(Be,Je),c(Be,Ze),c(Be,Ke),y(Ke,t[0]),c(Be,Qe),c(Be,Xe),c(Xe,Ye),c(W,et),c(W,tt),c(tt,nt),c(tt,st),c(tt,it),y(it,t[5]),c(tt,at),c(tt,lt),c(lt,ot),c(L,rt),c(L,ct),yt&&yt.m(ct,null),c(n,vt),c(n,dt),ut||(pt=[h(M,"click",t[12]),h(V,"click",(function(){i(t[9]?t[14]:t[13])&&(t[9]?t[14]:t[13]).apply(this,arguments)})),h(J,"change",t[15]),h(J,"input",t[15]),h(ne,"change",t[16]),h(ne,"input",t[16]),h(ve,"change",t[17]),h(ve,"input",t[17]),h(me,"change",t[18]),h(me,"input",t[18]),h(Ce,"change",t[19]),h(Ce,"input",t[19]),h(Ge,"change",t[20]),h(Ge,"input",t[20]),h(De,"change",t[21]),h(De,"input",t[21]),h(Ke,"change",t[22]),h(Ke,"input",t[22]),h(it,"change",t[23]),h(it,"input",t[23])],ut=!0)},p(e,[n]){t=e,512&n&&(M.disabled=t[9]),512&n&&bt!==(bt=t[9]?"Stop":"Start")&&m(D,bt),512&n&&(J.disabled=t[9]),2&n&&y(J,t[1]),2&n&&m(Q,t[1]),512&n&&(ne.disabled=t[9]),4&n&&y(ne,t[2]),4&n&&m(ae,t[2]),512&n&&(ve.disabled=t[9]),8&n&&y(ve,t[3]),8&n&&ht!==(ht=t[3].toFixed(4)+"")&&m(pe,ht),512&n&&(me.disabled=t[9]),16&n&&y(me,t[4]),16&n&&ft!==(ft=t[4].toFixed(3)+"")&&m(xe,ft),512&n&&(Ce.disabled=t[9]),64&n&&y(Ce,t[6]),64&n&&m(Ee,t[6]),512&n&&(Ge.disabled=t[9]),128&n&&y(Ge,t[7]),128&n&&m(Ae,t[7]),512&n&&(De.disabled=t[9]),256&n&&y(De,t[8]),256&n&&m(qe,t[8]),512&n&&(Ke.disabled=t[9]),1&n&&y(Ke,t[0]),2048&n&&m(Ye,t[11]),512&n&&(it.disabled=t[9]),32&n&&y(it,t[5]),32&n&&m(ot,t[5]),mt===(mt=gt(t))&&yt?yt.p(t,n):(yt&&yt.d(1),yt=mt&&mt(t),yt&&(yt.c(),yt.m(ct,null)))},i:e,o:e,d(e){e&&d(n),yt&&yt.d(),ut=!1,s(pt)}}}function V(e,t,n){let s,i,a=0,l=2e3,o=.001,r=.1,c=50,v=2,d=2,u=2,p=7614,b=6,h=!1,f=null;return e.$$.update=()=>{1&e.$$.dirty&&n(11,s=2**b)},[b,a,l,o,r,c,v,d,p,h,f,s,function(){n(1,a=0),n(2,l=2e3),n(3,o=.001),n(4,r=.1),n(5,c=50),n(6,v=2),n(7,d=2),u=2,n(8,p=7614),n(0,b=6)},async function(){try{n(9,h=!0);if(!(await fetch("http://localhost:8000/start_visualization",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({off_policy_value:a,n_iterations_value:l,lr_model_value:o,lr_logz_value:r,visualize_every:c,trajectory_length_value:v,hidden_layer_value:d,hidden_dim_value:u,seed_value:p,batch_size_value:s})})).ok)throw new Error("Failed to start visualization.");i=setInterval((async()=>{try{const e=await fetch("http://localhost:8000/get_visualization");if(!e.ok)throw new Error("Failed to fetch visualization.");const t=await e.json();if(t.image&&n(10,f=`data:image/png;base64,${t.image}`),t.completed)return console.log("Visualization process completed."),n(9,h=!1),void clearInterval(i)}catch(e){console.error(e)}}),500)}catch(e){console.error(e),n(9,h=!1)}},async function(){try{if(!(await fetch("http://localhost:8000/stop_visualization",{method:"POST"})).ok)throw new Error("Failed to stop visualization.");clearInterval(i),n(9,h=!1)}catch(e){console.error(e)}},function(){a=g(this.value),n(1,a)},function(){l=g(this.value),n(2,l)},function(){o=g(this.value),n(3,o)},function(){r=g(this.value),n(4,r)},function(){v=g(this.value),n(6,v)},function(){d=g(this.value),n(7,d)},function(){p=g(this.value),n(8,p)},function(){b=g(this.value),n(0,b)},function(){c=g(this.value),n(5,c)}]}return new class extends A{constructor(e){super(),M(this,e,V,I,a,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
