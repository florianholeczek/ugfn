var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function s(e){e.forEach(t)}function i(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let o,l;function r(e,t){return o||(o=document.createElement("a")),o.href=t,e===o.href}function c(e,t){e.appendChild(t)}function v(e,t,n){e.insertBefore(t,n||null)}function d(e){e.parentNode&&e.parentNode.removeChild(e)}function u(e){return document.createElement(e)}function p(e){return document.createTextNode(e)}function f(){return p(" ")}function h(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function b(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function g(e){return""===e?null:+e}function m(e,t){t=""+t,e.data!==t&&(e.data=t)}function y(e,t){e.value=null==t?"":t}function w(e,t,n,s){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,s?"important":"")}function $(e){l=e}const x=[],_=[];let z=[];const k=[],E=Promise.resolve();let F=!1;function L(e){z.push(e)}const T=new Set;let C=0;function N(){if(0!==C)return;const e=l;do{try{for(;C<x.length;){const e=x[C];C++,$(e),S(e.$$)}}catch(e){throw x.length=0,C=0,e}for($(null),x.length=0,C=0;_.length;)_.pop()();for(let e=0;e<z.length;e+=1){const t=z[e];T.has(t)||(T.add(t),t())}z.length=0}while(x.length);for(;k.length;)k.pop()();F=!1,T.clear(),$(e)}function S(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(L)}}const O=new Set;function G(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];z.forEach((s=>-1===e.indexOf(s)?t.push(s):n.push(s))),n.forEach((e=>e())),z=t}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function M(e,t){-1===e.$$.dirty[0]&&(x.push(e),F||(F=!0,E.then(N)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function A(a,o,r,c,v,u,p,f=[-1]){const h=l;$(a);const b=a.$$={fragment:null,ctx:[],props:u,update:e,not_equal:v,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(h?h.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:o.target||h.$$.root};p&&p(b.root);let g=!1;if(b.ctx=r?r(a,o.props||{},((e,t,...n)=>{const s=n.length?n[0]:t;return b.ctx&&v(b.ctx[e],b.ctx[e]=s)&&(!b.skip_bound&&b.bound[e]&&b.bound[e](s),g&&M(a,e)),t})):[],b.update(),g=!0,s(b.before_update),b.fragment=!!c&&c(b.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);b.fragment&&b.fragment.l(e),e.forEach(d)}else b.fragment&&b.fragment.c();o.intro&&((m=a.$$.fragment)&&m.i&&(O.delete(m),m.i(y))),function(e,n,a,o){const{fragment:l,after_update:r}=e.$$;l&&l.m(n,a),o||L((()=>{const n=e.$$.on_mount.map(t).filter(i);e.$$.on_destroy?e.$$.on_destroy.push(...n):s(n),e.$$.on_mount=[]})),r.forEach(L)}(a,o.target,o.anchor,o.customElement),N()}var m,y;$(h)}class H{$destroy(){G(this,1),this.$destroy=e}$on(t,n){if(!i(n))return e;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const e=s.indexOf(n);-1!==e&&s.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function P(t){let n;return{c(){n=u("p"),n.textContent="Loading visualization...",b(n,"class","svelte-6v464b")},m(e,t){v(e,n,t)},p:e,d(e){e&&d(n)}}}function j(e){let t,n;return{c(){t=u("img"),r(t.src,n=e[5])||b(t,"src",n),b(t,"alt","Visualization"),b(t,"class","svelte-6v464b")},m(e,n){v(e,t,n)},p(e,s){32&s&&!r(t.src,n=e[5])&&b(t,"src",n)},d(e){e&&d(t)}}}function I(t){let n,a,o,l,r,g,$,x,_,z,k,E,F,L,T,C,N,S,O,G,M,A,H,I,V,R,W,q,D,B,J,U,Z,K,Q,X,Y,ee,te,ne,se,ie,ae,oe,le,re,ce,ve,de,ue,pe,fe,he,be,ge,me,ye,we,$e,xe,_e,ze,ke,Ee,Fe,Le=t[4]?"Stop":"Start",Te=t[2].toFixed(4)+"",Ce=t[3].toFixed(3)+"";function Ne(e,t){return e[5]?j:e[4]?P:void 0}let Se=Ne(t),Oe=Se&&Se(t);return{c(){n=u("main"),a=u("div"),o=f(),l=u("header"),l.innerHTML='<div class="container svelte-6v464b"><h1 class="title svelte-6v464b">Understanding GFlowNets</h1> \n      <p class="subtitle svelte-6v464b">Gaining intuition for Generative Flow Networks and how to train them</p></div>',r=f(),g=u("section"),g.innerHTML='<h2 class="section-title svelte-6v464b">What is a GFlowNet?</h2> \n    <p class="section-text svelte-6v464b">Short Description: What can they do, how do they work, advantages</p> \n\n    <h2 class="section-title svelte-6v464b">Toy Environment</h2> \n    <p class="section-text svelte-6v464b">A 2-dimensional multivariate Gaussian environment with two modes. GFlowNet\n      takes steps in the x or y direction, and rewards are calculated based on the mixture of\n      Gaussians.</p> \n    <ul class="bullet-list svelte-6v464b"><li class="svelte-6v464b">Variable sequence length is typically supported, but fixed here for simplicity.</li> \n      <li class="svelte-6v464b">State does not depend on the order of steps.</li> \n      <li class="svelte-6v464b">Added a counter to avoid circular paths in the graph.</li></ul> \n    <div class="image-container svelte-6v464b"><img src="/images/env1.png" class="image svelte-6v464b" alt="Rendering of the environment"/></div>',$=f(),x=u("section"),x.innerHTML='<h2 class="section-title svelte-6v464b">Training</h2> \n    <p class="section-text svelte-6v464b">Visualizing how GFlowNet samples from the underlying distribution.\n      -&gt; Learns full distribution given enough compute\n      TODO: Add slider over training iterations to visualizations to add interactivity and see training progress</p> \n    <div class="image-container svelte-6v464b"><img src="/images/run1.png" class="image svelte-6v464b" alt="GFN samples from the underlying distribution"/></div> \n\n    <h2 class="section-title svelte-6v464b">Mode Collapse</h2> \n    <p class="section-text svelte-6v464b">If there is little probability mass between modes, we see mode collapse.</p> \n    <div class="image-container svelte-6v464b"><img src="/images/run2.png" class="image svelte-6v464b" alt="Low variance leads to sampling from one mode"/></div> \n    <p class="section-text svelte-6v464b">Training off-policy mitigates this issue.\n      We added variance to each step -&gt; more exploring</p> \n    <div class="image-container svelte-6v464b"><img src="/images/run3.png" class="image svelte-6v464b" alt="Off-policy training helps"/></div>',_=f(),z=u("section"),z.innerHTML='<h2 class="section-title svelte-6v464b">Flow</h2> \n    <p class="section-text svelte-6v464b">Visualize flow between states. Probably interactive:\n      Hovering over env and displaying flow in 8 directions with arrows.\n      Probably need to discretize for this?</p>',k=f(),E=u("section"),E.innerHTML='<div class="container svelte-6v464b"><h1 class="title svelte-6v464b">Playground</h1> \n      <p class="subtitle svelte-6v464b">Change the environment and train your own GFlowNet to get a feeling on how they work.</p></div>',F=f(),L=u("section"),T=u("p"),T.textContent="change env (up to 4 gaussians, change their mean and var by dragging and scaling on the image)",C=f(),N=u("div"),N.innerHTML='<img src="/images/env1.png" class="image svelte-6v464b" alt="Rendering of the environment"/>',S=f(),O=u("p"),O.textContent="change training settings and start training (visualize training by sampling every n steps),\n      all interactivty deactivated while training, add stop button.",G=f(),M=u("div"),A=u("button"),H=p("Reset"),I=f(),V=u("button"),R=p(Le),W=f(),q=u("div"),D=u("div"),B=u("label"),B.textContent="Off-policy",J=f(),U=u("input"),Z=f(),K=u("span"),Q=p(t[0]),X=f(),Y=u("div"),ee=u("label"),ee.textContent="Iterations to train",te=f(),ne=u("input"),se=f(),ie=u("span"),ae=p(t[1]),oe=f(),le=u("div"),re=u("label"),re.textContent="Learning rate of the model",ce=f(),ve=u("input"),de=f(),ue=u("span"),pe=p(Te),fe=f(),he=u("div"),be=u("label"),be.textContent="Learning rate of LogZ",ge=f(),me=u("input"),ye=f(),we=u("span"),$e=p(Ce),xe=f(),_e=u("div"),Oe&&Oe.c(),ze=f(),ke=u("section"),ke.innerHTML='<h2 class="section-title svelte-6v464b">Sources</h2> \n    <p class="section-text svelte-6v464b">Add sources</p>',b(a,"id","plot-container"),w(a,"width","100%"),w(a,"height","100%"),b(a,"class","svelte-6v464b"),b(l,"class","header svelte-6v464b"),b(g,"class","section svelte-6v464b"),b(x,"class","section section-light svelte-6v464b"),b(z,"class","section svelte-6v464b"),b(E,"class","playground svelte-6v464b"),b(T,"class","section-text svelte-6v464b"),b(N,"class","image-container svelte-6v464b"),b(O,"class","section-text svelte-6v464b"),b(A,"class","reset-button svelte-6v464b"),A.disabled=t[4],b(V,"class","reset-button svelte-6v464b"),b(M,"class","buttonscontainer svelte-6v464b"),b(B,"for","off_policy"),b(B,"class","svelte-6v464b"),b(U,"type","range"),b(U,"min","0"),b(U,"max","3"),b(U,"step","0.1"),b(U,"id","off_policy"),U.disabled=t[4],b(U,"class","svelte-6v464b"),b(K,"class","svelte-6v464b"),b(D,"class","slider svelte-6v464b"),b(ee,"for","n_iterations"),b(ee,"class","svelte-6v464b"),b(ne,"type","range"),b(ne,"min","100"),b(ne,"max","10000"),b(ne,"step","10"),b(ne,"id","n_iterations"),ne.disabled=t[4],b(ne,"class","svelte-6v464b"),b(ie,"class","svelte-6v464b"),b(Y,"class","slider svelte-6v464b"),b(re,"for","lr_model"),b(re,"class","svelte-6v464b"),b(ve,"type","range"),b(ve,"min","0.0001"),b(ve,"max","0.1"),b(ve,"step","0.0001"),b(ve,"id","lr_model"),ve.disabled=t[4],b(ve,"class","svelte-6v464b"),b(ue,"class","svelte-6v464b"),b(le,"class","slider svelte-6v464b"),b(be,"for","lr_logz"),b(be,"class","svelte-6v464b"),b(me,"type","range"),b(me,"min","0.001"),b(me,"max","0.3"),b(me,"step","0.001"),b(me,"id","lr_logz"),me.disabled=t[4],b(me,"class","svelte-6v464b"),b(we,"class","svelte-6v464b"),b(he,"class","slider svelte-6v464b"),b(q,"class","slider-container svelte-6v464b"),b(_e,"class","visualization svelte-6v464b"),b(L,"class","section-light svelte-6v464b"),b(ke,"class","section svelte-6v464b"),b(n,"class","main-content svelte-6v464b")},m(e,s){v(e,n,s),c(n,a),c(n,o),c(n,l),c(n,r),c(n,g),c(n,$),c(n,x),c(n,_),c(n,z),c(n,k),c(n,E),c(n,F),c(n,L),c(L,T),c(L,C),c(L,N),c(L,S),c(L,O),c(L,G),c(L,M),c(M,A),c(A,H),c(M,I),c(M,V),c(V,R),c(L,W),c(L,q),c(q,D),c(D,B),c(D,J),c(D,U),y(U,t[0]),c(D,Z),c(D,K),c(K,Q),c(q,X),c(q,Y),c(Y,ee),c(Y,te),c(Y,ne),y(ne,t[1]),c(Y,se),c(Y,ie),c(ie,ae),c(q,oe),c(q,le),c(le,re),c(le,ce),c(le,ve),y(ve,t[2]),c(le,de),c(le,ue),c(ue,pe),c(q,fe),c(q,he),c(he,be),c(he,ge),c(he,me),y(me,t[3]),c(he,ye),c(he,we),c(we,$e),c(L,xe),c(L,_e),Oe&&Oe.m(_e,null),c(n,ze),c(n,ke),Ee||(Fe=[h(A,"click",t[6]),h(V,"click",(function(){i(t[4]?t[8]:t[7])&&(t[4]?t[8]:t[7]).apply(this,arguments)})),h(U,"change",t[9]),h(U,"input",t[9]),h(ne,"change",t[10]),h(ne,"input",t[10]),h(ve,"change",t[11]),h(ve,"input",t[11]),h(me,"change",t[12]),h(me,"input",t[12])],Ee=!0)},p(e,[n]){t=e,16&n&&(A.disabled=t[4]),16&n&&Le!==(Le=t[4]?"Stop":"Start")&&m(R,Le),16&n&&(U.disabled=t[4]),1&n&&y(U,t[0]),1&n&&m(Q,t[0]),16&n&&(ne.disabled=t[4]),2&n&&y(ne,t[1]),2&n&&m(ae,t[1]),16&n&&(ve.disabled=t[4]),4&n&&y(ve,t[2]),4&n&&Te!==(Te=t[2].toFixed(4)+"")&&m(pe,Te),16&n&&(me.disabled=t[4]),8&n&&y(me,t[3]),8&n&&Ce!==(Ce=t[3].toFixed(3)+"")&&m($e,Ce),Se===(Se=Ne(t))&&Oe?Oe.p(t,n):(Oe&&Oe.d(1),Oe=Se&&Se(t),Oe&&(Oe.c(),Oe.m(_e,null)))},i:e,o:e,d(e){e&&d(n),Oe&&Oe.d(),Ee=!1,s(Fe)}}}function V(e,t,n){let s,i=0,a=2e3,o=.001,l=.1,r=!1,c=null;return[i,a,o,l,r,c,function(){n(0,i=0),n(1,a=2e3),n(2,o=.001),n(3,l=.1)},async function(){try{n(4,r=!0);if(!(await fetch("http://localhost:8000/start_visualization",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({off_policy_value:i,n_iterations_value:a,lr_model_value:o,lr_logz_value:l,visualize_every:50})})).ok)throw new Error("Failed to start visualization.");s=setInterval((async()=>{try{const e=await fetch("http://localhost:8000/get_visualization");if(!e.ok)throw new Error("Failed to fetch visualization.");const t=await e.json();if(t.image&&n(5,c=`data:image/png;base64,${t.image}`),t.completed)return console.log("Visualization process completed."),n(4,r=!1),void clearInterval(s)}catch(e){console.error(e)}}),1e3)}catch(e){console.error(e),n(4,r=!1)}},async function(){try{if(!(await fetch("http://localhost:8000/stop_visualization",{method:"POST"})).ok)throw new Error("Failed to stop visualization.");clearInterval(s),n(4,r=!1)}catch(e){console.error(e)}},function(){i=g(this.value),n(0,i)},function(){a=g(this.value),n(1,a)},function(){o=g(this.value),n(2,o)},function(){l=g(this.value),n(3,l)}]}return new class extends H{constructor(e){super(),A(this,e,V,I,a,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
